import React, { useMemo, useState, useEffect } from "react";
import { motion } from "framer-motion";

// One-file, bilingual (English/Tamil) landing page for Lucky Murugan (AMMK)
// Notes:
// 1) Replace placeholder images/logos below with your own assets.
// 2) Using any party symbol/logo may require permission from the rights holder/election authority.
// 3) All claims in "Reports" and "People Affected" must be verifiable; add sources before publishing.

const content = {
  en: {
    langLabel: "English",
    switchTo: "தமிழ்",
    nav: {
      home: "Home",
      about: "About",
      leader: "Leader",
      legacy: "Jayalalithaa's Welfare",
      reports: "Issues & Reports",
      affected: "People Affected",
      contact: "Contact",
    },
    hero: {
      title: "Lucky Murugan",
      subtitle:
        "AMMK — Amma Makkal Munnetra Kazhagam | Porur, Chennai",
      cta1: "Volunteer",
      cta2: "Know More",
    },
    about: {
      heading: "About Lucky Murugan",
      body:
        "Lucky Murugan is an active AMMK cadre and follower of T.T.V. Dhinakaran, working at the grassroots in and around Porur to address local needs and support people's welfare.",
      bullets: [
        "Focus on civic issues: water, sanitation, roads",
        "Support for youth employment & skills",
        "Transparent, people‑first engagement",
      ],
    },
    leader: {
      heading: "Leader — T.T.V. Dhinakaran",
      body:
        "Guided by the leadership of T.T.V. Dhinakaran, AMMK aims to uphold Amma's legacy and ensure responsive governance that listens to every household.",
    },
    legacy: {
      heading: "Jayalalithaa's Welfare Schemes (Highlights)",
      note:
        "Below are example placeholders. Replace with the exact scheme names, years, and verified details.",
      items: [
        {
          title: "Amma Canteen (Subsidized Meals)",
          desc:
            "Affordable, hygienic meals aimed at supporting urban poor and working communities.",
        },
        {
          title: "Amma Pharmacy / Cement / Water Initiatives",
          desc:
            "Citizen‑centric pricing and access to essentials to reduce household costs.",
        },
        {
          title: "Education & Girl‑Child Support",
          desc:
            "Scholarships, bicycles, laptops, and incentives to improve enrolment and retention.",
        },
      ],
    },
    reports: {
      heading: "Issues & Reports (for Public Review)",
      disclaimer:
        "Add fact‑checked content only. Include dates, locations, outcomes, and source links. Claims must be verifiable before publication.",
      tableHead: ["Title", "Summary", "Source URL"],
      sample: [
        {
          title: "Example: Civic Grievance in Ward X",
          summary:
            "Residents reported sewage overflow for 10 days; petition submitted with photos.",
          url: "https://example.com/source",
        },
      ],
    },
    affected: {
      heading: "People Affected by Current Ruling (DMK)",
      disclaimer:
        "This section lists common areas of public impact. Add LOCAL, VERIFIABLE cases with dates, names (with consent), and evidence links. Avoid defamatory or unverified claims.",
      categories: [
        {
          area: "Cost of Living & Tariffs",
          impacts: [
            "Rise in prices of essentials and household expenses.",
            "Electricity tariff revisions impacting domestic and small business consumers.",
            "Fuel price burden increasing transport and goods costs.",
          ],
        },
        {
          area: "Jobs, MSMEs & Traders",
          impacts: [
            "Slower job creation and hiring freezes in select sectors.",
            "Licensing/permit delays affecting small traders and micro‑enterprises.",
            "Payment delays in government tenders and vendor bills.",
          ],
        },
        {
          area: "Farmers & Water Management",
          impacts: [
            "Delayed subsidies/insurance settlements in some districts.",
            "Irrigation release and water sharing issues affecting crop cycles.",
            "Price realization challenges for perishables due to market volatility.",
          ],
        },
        {
          area: "Law & Order / Public Safety",
          impacts: [
            "Concerns over crime and local safety in specific pockets.",
            "Women’s safety incidents and inadequate street lighting or patrolling.",
          ],
        },
        {
          area: "Education",
          impacts: [
            "Irregular disbursal of scholarships/benefits in some cases.",
            "Infrastructure gaps in select government schools and colleges.",
            "Fee pressures on parents in private institutions.",
          ],
        },
        {
          area: "Healthcare",
          impacts: [
            "Overcrowding and resource shortages at certain government hospitals.",
            "Medicine/consumable stock‑outs reported intermittently.",
          ],
        },
        {
          area: "Urban Civic Services",
          impacts: [
            "Water supply interruptions and sewage overflow complaints.",
            "Road damage, potholes, and slow maintenance cycles.",
            "Solid waste management lapses and mosquito menace in monsoons.",
          ],
        },
        {
          area: "Welfare Delivery & Transparency",
          impacts: [
            "Delays or exclusions in beneficiary lists and scheme rollouts.",
            "Perceived corruption/undue influence in local offices.",
          ],
        },
        {
          area: "Taxes, Fees & Compliance",
          impacts: [
            "Hikes in local levies/charges increasing household and business costs.",
            "Complex compliance for small traders without adequate support.",
          ],
        },
      ],
      form: {
        title: "Add a Verified Case",
        labels: {
          name: "Name (optional)",
          location: "Location",
          date: "Date",
          category: "Category",
          description: "Description (what happened)",
          source: "Source URL (evidence)",
          consent: "I have consent to share this information",
          submit: "Add Case",
        },
      },
    },
    contact: {
      heading: "Contact",
      addressTitle: "Office / Area",
      address:
        "Porur, Chennai — Reach out for local issues, volunteering, and events.",
      phone: "Phone",
      email: "Email",
      placeholders: {
        phone: "+91-XXXXXXXXXX",
        email: "contact@lucky-murugan.in",
      },
      mapNote:
        "Embed a Google Map iframe for Porur here if you have an API/Embed link.",
    },
    footer: {
      note:
        "Paid for by supporters of Lucky Murugan (AMMK). Please verify all facts and sources before publication.",
    },
  },
  ta: {
    langLabel: "தமிழ்",
    switchTo: "English",
    nav: {
      home: "முகப்பு",
      about: "அறிமுகம்",
      leader: "தலைவர்",
      legacy: "அம்மா நலத்திட்டங்கள்",
      reports: "சிக்கல்கள் & அறிக்கைகள்",
      affected: "பாதிக்கப்பட்ட மக்கள்",
      contact: "தொடர்பு",
    },
    hero: {
      title: "லக்கி முருகன்",
      subtitle:
        "AMMK — அம்மா மக்கள் முன்னேற்றக் கழகம் | போர்ூர், சென்னை",
      cta1: "தன்னார்வலராக சேரவும்",
      cta2: "மேலும் அறிய",
    },
    about: {
      heading: "லக்கி முருகன் — அறிமுகம்",
      body:
        "T.T.V. தினகரன் அவர்களின் வழிகாட்டுதலின் கீழ் செயல்படும் AMMK தொண்டர் லக்கி முருகன், போர்ூர் சுற்றுவட்டார மக்களின் பிரச்சினைகளை தீர்க்கும் பணியில் தீவிரமாக ஈடுபட்டு வருகிறார்.",
      bullets: [
        "குடிநீர், கழிவு நீர், சாலை போன்ற நகர்ப்புற அடிக்கோளங்கள்",
        "இளைஞர் வேலைவாய்ப்பு & திறன் மேம்பாடு",
        "வெளிப்படையான, மக்கள் மைய அணுகுமுறை",
      ],
    },
    leader: {
      heading: "தலைவர் — T.T.V. தினகரன்",
      body:
        "அம்மாவின் பாரம்பரியத்தை நிலைநிறுத்தி, ஒவ்வொரு இல்லத்திற்கும் செவிசாய்க்கும் நிர்வாகத்தை உருவாக்கும் நோக்கில் AMMK செயல்படுகிறது.",
    },
    legacy: {
      heading: "அம்மா நலத்திட்டங்கள் (முக்கியங்கள்)",
      note:
        "கீழே கொடுக்கப்பட்டுள்ளவை எடுத்துக்காட்டு இடப்பூர்த்திகள். திட்டத்தின் சரியான பெயர், ஆண்டு, துல்லியமான விவரங்களைச் சேர்க்கவும்.",
      items: [
        {
          title: "அம்மா உணவகம்",
          desc:
            "நகர்ப்புற ஏழைகள் மற்றும் தொழிலாளர் மக்களுக்கு குறைந்த கட்டணத்தில் சத்துள்ள உணவு.",
        },
        {
          title: "அம்மா மருந்தகம் / சிமெண்டு / குடிநீர் முயற்சிகள்",
          desc:
            "மக்கள் நலனை கருத்தில் கொண்டு மலிவான விலையில் அத்தியாவசிய பொருட்கள்.",
        },
        {
          title: "கல்வி & சிறுமி ஆதரவு",
          desc:
            "உதவித்தொகைகள், சைக்கிள்கள், லாப்டாப்கள் உள்ளிட்ட ஊக்கத்திட்டங்கள்.",
        },
      ],
    },
    reports: {
      heading: "சிக்கல்கள் & பொதுமக்கள் அறிக்கைகள்",
      disclaimer:
        "உறுதியான ஆதாரங்களுடன் மட்டுமே தகவலை பதிவிடவும். தேதி, இடம், முடிவு மற்றும் மூலம் இணைப்பைச் சேர்க்கவும்.",
      tableHead: ["தலைப்பு", "சுருக்கம்", "மூலம் URL"],
      sample: [
        {
          title: "எடுத்துக்காட்டு: வார்டு X - குடிநீர் புகார்",
          summary:
            "10 நாட்களுக்கு கழிவு நீர் நிரம்பியது; புகைப்படங்களுடன் மனு சமர்ப்பிக்கப்பட்டது.",
          url: "https://example.com/source",
        },
      ],
    },
    affected: {
      heading: "தற்போதைய ஆட்சியில் (DMK) பாதிக்கப்பட்ட மக்கள்",
      disclaimer:
        "பொதுவான பாதிப்பு பகுதிகள் பட்டியல். உள்ளூர், சரிபார்க்கக்கூடிய வழக்குகளை தேதி, பெயர் (ஒப்புதல்), ஆதாரம் இணைப்புடன் சேர்க்கவும். உறுதி செய்யப்படாத/தூற்றல் உள்ளடக்கத்தை தவிர்க்கவும்.",
      categories: [
        {
          area: "வாழ்க்கைச் செலவும் கட்டணங்களும்",
          impacts: [
            "அத்தியாவசிய பொருட்களின் விலை உயர்வு.",
            "மின்சார கட்டண மாற்றங்கள் — வீட்டு/சிறுதொழில்களுக்கு பாதிப்பு.",
            "எரிபொருள் விலைசுமை — போக்குவரத்து/சரக்கு செலவு அதிகரிப்பு.",
          ],
        },
        {
          area: "வேலைவாய்ப்பு, MSME & வியாபாரிகள்",
          impacts: [
            "சில துறைகளில் வேலைவாய்ப்பு மந்தநிலை.",
            "அனுமதி/லைசன்ஸ் தாமதங்கள் — சிறுவியாபாரங்களுக்கு சிரமம்.",
            "அரசு டெண்டர்/வெண்டர் பில்கள் செலுத்தும் தாமதங்கள்.",
          ],
        },
        {
          area: "விவசாயிகள் & நீர் மேலாண்மை",
          impacts: [
            "துணைத் தொகை/காப்பீடு வழங்கலில் தாமதம்.",
            "பாசன நீர் விடுவிப்பு/பகிர்வு சிக்கல்கள் — பயிர்சுழற்சி பாதிப்பு.",
            "காய்கறி/பழ விலை நிலைமாறுதல் — வருவாய் சவால்கள்.",
          ],
        },
        {
          area: "சட்டம் & ஒழுங்கு/பாதுகாப்பு",
          impacts: [
            "சில பகுதிகளில் குற்றச்செயல்கள் குறித்த கவலைகள்.",
            "பெண்கள் பாதுகாப்பு — தெருவிளக்கு/காவல் பற்றாக்குறை குறைகள்.",
          ],
        },
        {
          area: "கல்வி",
          impacts: [
            "உதவித்தொகை/பலன்கள் வழங்கலில் இடையூறு.",
            "சில அரசு பள்ளி/கல்லூரிகளில் மென்பொருள்/அடிப்படை வசதி குறைபாடுகள்.",
            "தனியார் கல்வி கட்டணச் சுமை.",
          ],
        },
        {
          area: "மருத்துவம்",
          impacts: [
            "சில அரசு மருத்துவமனைகளில் கூட்டம்/வளத் தட்டுப்பாடு.",
            "மருந்து/நுகர்வுப் பொருட்களின் தற்காலிக பற்றாக்குறை.",
          ],
        },
        {
          area: "நகர்ப்புற அடிப்படை சேவைகள்",
          impacts: [
            "குடிநீர் விநியோக தடைகள், கழிவு நீர் நிரம்பல் புகார்கள்.",
            "சாலைகள் சேதம், குழிப்பாதைகள், பராமரிப்பு தாமதம்.",
            "தூய்மை/குப்பை மேலாண்மை குறைபாடுகள், பருவமழையில் கொசு தொல்லை.",
          ],
        },
        {
          area: "நலத் திட்ட விநியோகம் & வெளிப்படைத் தன்மை",
          impacts: [
            "பட்டியலிடலில் தாமதம்/விலக்கு, திட்ட அமலாக்க தாமதம்.",
            "உள்ளூர் அலுவலகங்களில் ஊழல்/அதிகாரம் தவறாகப் பயன்படுத்துதல் குற்றச்சாட்டுகள்.",
          ],
        },
        {
          area: "வரி, கட்டணம் & ஒழுங்குமுறை",
          impacts: [
            "உள்ளூர் வரிகள்/கட்டண உயர்வு — குடும்ப/தொழில் செலவுகள் அதிகரிப்பு.",
            "சிறுவியாபாரிகளுக்கு ஒழுங்குமுறை சிக்கல்கள் — போதிய வழிகாட்டல் இல்லாமை.",
          ],
        },
      ],
      form: {
        title: "சரிபார்க்கப்பட்ட வழக்கை சேர்க்கவும்",
        labels: {
          name: "பெயர் (விருப்பம்)",
          location: "இடம்",
          date: "தேதி",
          category: "பகுப்பு",
          description: "விளக்கம் (என்ன நடந்தது)",
          source: "மூலம் URL (ஆதாரம்)",
          consent: "இந்த தகவலைப் பகிர அனுமதி உள்ளது",
          submit: "வழக்கைச் சேர்க்கவும்",
        },
      },
    },
    contact: {
      heading: "தொடர்பு",
      addressTitle: "அலுவலகம் / பகுதி",
      address:
        "போர்ூர், சென்னை — உள்ளூர் பிரச்சினைகள், தன்னார்வம், நிகழ்வுகள் தொடர்பாக தொடர்புகொள்ளவும்.",
      phone: "தொலைபேசி",
      email: "மின்னஞ்சல்",
      placeholders: {
        phone: "+91-XXXXXXXXXX",
        email: "contact@lucky-murugan.in",
      },
      mapNote:
        "Google Map iframe ஐ (போர்ூர்) இங்கு பதியலாம்.",
    },
    footer: {
      note:
        "லக்கி முருகன் (AMMK) ஆதரவாளர்கள் சார்பில் வெளியீடு. வெளியீட்டிற்கு முன் அனைத்து தகவல்களும் சரிபார்க்கப்பட வேண்டும்.",
    },
  },
};

const Logo = () => (
  <div className="flex items-center gap-3">
    {/* Replace this circle with the official AMMK symbol/logo as permitted */}
    <div className="h-9 w-9 rounded-full bg-gradient-to-br from-green-500 to-emerald-700 shadow" />
    <span className="font-semibold tracking-wide">AMMK • Lucky Murugan</span>
  </div>
);

const Nav = ({ t, onSwitch }) => (
  <header className="backdrop-blur bg-white/70 sticky top-0 z-50 border-b">
    <div className="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
      <Logo />
      <nav className="hidden md:flex items-center gap-6 text-sm">
        <a href="#home" className="hover:text-emerald-700">{t.nav.home}</a>
        <a href="#about" className="hover:text-emerald-700">{t.nav.about}</a>
        <a href="#leader" className="hover:text-emerald-700">{t.nav.leader}</a>
        <a href="#legacy" className="hover:text-emerald-700">{t.nav.legacy}</a>
        <a href="#reports" className="hover:text-emerald-700">{t.nav.reports}</a>
        <a href="#affected" className="hover:text-emerald-700">{t.nav.affected}</a>
        <a href="#contact" className="hover:text-emerald-700">{t.nav.contact}</a>
      </nav>
      <button
        onClick={onSwitch}
        className="px-3 py-1.5 rounded-2xl border shadow-sm text-sm hover:shadow transition"
      >
        {t.switchTo}
      </button>
    </div>
  </header>
);

const Hero = ({ t }) => (
  <section id="home" className="relative overflow-hidden">
    <div className="absolute inset-0 bg-gradient-to-br from-emerald-50 via-white to-emerald-50" />
    <div className="relative max-w-6xl mx-auto px-4 pt-16 pb-20 grid md:grid-cols-2 gap-10 items-center">
      <motion.div
        initial={{ opacity: 0, y: 16 }}
        whileInView={{ opacity: 1, y: 0 }}
        viewport={{ once: true }}
        transition={{ duration: 0.6 }}
      >
        <h1 className="text-4xl md:text-5xl font-extrabold leading-tight">
          {t.hero.title}
        </h1>
        <p className="mt-3 text-slate-600 text-lg">{t.hero.subtitle}</p>
        <div className="mt-6 flex gap-3">
          <a href="#contact" className="px-5 py-2.5 bg-emerald-600 text-white rounded-2xl shadow hover:bg-emerald-700">
            {t.hero.cta1}
          </a>
          <a href="#about" className="px-5 py-2.5 border rounded-2xl shadow-sm hover:shadow">
            {t.hero.cta2}
          </a>
        </div>
      </motion.div>
      <motion.div
        initial={{ opacity: 0, y: 16 }}
        whileInView={{ opacity: 1, y: 0 }}
        viewport={{ once: true }}
        transition={{ duration: 0.6, delay: 0.1 }}
        className="relative"
      >
        {/* Replace src with candidate/party imagery you have rights to use */}
        <div className="aspect-[4/3] rounded-3xl bg-white shadow-inner border p-2">
          <div className="w-full h-full rounded-2xl bg-[url('https://images.unsplash.com/photo-1551836022-d5d88e9218df?q=80&w=1200&auto=format&fit=crop')] bg-cover bg-center" />
        </div>
      </motion.div>
    </div>
  </section>
);

const About = ({ t }) => (
  <section id="about" className="max-w-6xl mx-auto px-4 py-14">
    <motion.div initial={{ opacity: 0, y: 16 }} whileInView={{ opacity: 1, y: 0 }} viewport={{ once: true }} transition={{ duration: 0.6 }}>
      <h2 className="text-2xl md:text-3xl font-bold">{t.about.heading}</h2>
      <p className="mt-3 text-slate-700 leading-relaxed">{t.about.body}</p>
      <ul className="mt-5 grid md:grid-cols-3 gap-3">
        {t.about.bullets.map((b, i) => (
          <li key={i} className="p-4 rounded-2xl border bg-white shadow-sm">{b}</li>
        ))}
      </ul>
    </motion.div>
  </section>
);

const Leader = ({ t }) => (
  <section id="leader" className="bg-gradient-to-br from-white to-emerald-50 border-y">
    <div className="max-w-6xl mx-auto px-4 py-14 grid md:grid-cols-2 gap-10 items-center">
      <motion.div initial={{ opacity: 0, y: 16 }} whileInView={{ opacity: 1, y: 0 }} viewport={{ once: true }} transition={{ duration: 0.6 }}>
        <h2 className="text-2xl md:text-3xl font-bold">{t.leader.heading}</h2>
        <p className="mt-3 text-slate-700 leading-relaxed">{t.leader.body}</p>
      </motion.div>
      <motion.div initial={{ opacity: 0, y: 16 }} whileInView={{ opacity: 1, y: 0 }} viewport={{ once: true }} transition={{ duration: 0.6, delay: 0.1 }}>
        {/* Replace with a permitted portrait of T.T.V. Dhinakaran */}
        <div className="aspect-[4/3] rounded-3xl bg-white shadow-inner border p-2">
          <div className="w-full h-full rounded-2xl bg-[url('https://images.unsplash.com/photo-1517245386807-bb43f82c33c4?q=80&w=1200&auto=format&fit=crop')] bg-cover bg-center" />
        </div>
      </motion.div>
    </div>
  </section>
);

const Legacy = ({ t }) => (
  <section id="legacy" className="max-w-6xl mx-auto px-4 py-14">
    <motion.div initial={{ opacity: 0, y: 16 }} whileInView={{ opacity: 1, y: 0 }} viewport={{ once: true }} transition={{ duration: 0.6 }}>
      <h2 className="text-2xl md:text-3xl font-bold">{t.legacy.heading}</h2>
      <p className="mt-2 text-sm text-slate-600">{t.legacy.note}</p>
      <div className="mt-6 grid md:grid-cols-3 gap-4">
        {t.legacy.items.map((it, i) => (
          <div key={i} className="p-5 rounded-3xl border bg-white shadow-sm">
            <h3 className="font-semibold text-lg">{it.title}</h3>
            <p className="mt-2 text-slate-700 leading-relaxed">{it.desc}</p>
          </div>
        ))}
      </div>
    </motion.div>
  </section>
);

const Reports = ({ t, lang }) => {
  const [rows, setRows] = useState(t.reports.sample);
  const [form, setForm] = useState({ title: "", summary: "", url: "" });

  useEffect(() => {
    setRows(t.reports.sample);
    setForm({ title: "", summary: "", url: "" });
  }, [lang, t.reports.sample]);

  const addRow = (e) => {
    e.preventDefault();
    if (!form.title || !form.summary) return;
    setRows((r) => [...r, form]);
    setForm({ title: "", summary: "", url: "" });
  };

  return (
    <section id="reports" className="bg-gradient-to-br from-emerald-50 to-white border-y">
      <div className="max-w-6xl mx-auto px-4 py-14">
        <motion.div initial={{ opacity: 0, y: 16 }} whileInView={{ opacity: 1, y: 0 }} viewport={{ once: true }} transition={{ duration: 0.6 }}>
          <h2 className="text-2xl md:text-3xl font-bold">{t.reports.heading}</h2>
          <p className="mt-2 text-sm text-slate-600">{t.reports.disclaimer}</p>

          <div className="mt-6 overflow-x-auto">
            <table className="w-full text-left text-sm border-separate [border-spacing:0] rounded-2xl overflow-hidden">
              <thead>
                <tr className="bg-white">
                  {t.reports.tableHead.map((h, i) => (
                    <th key={i} className="p-3 border-b font-semibold">{h}</th>
                  ))}
                </tr>
              </thead>
              <tbody>
                {rows.map((r, i) => (
                  <tr key={i} className="odd:bg-white even:bg-emerald-50/40">
                    <td className="p-3 border-b align-top">{r.title}</td>
                    <td className="p-3 border-b align-top">{r.summary}</td>
                    <td className="p-3 border-b align-top">
                      {r.url ? (
                        <a className="text-emerald-700 underline break-all" href={r.url} target="_blank" rel="noreferrer">
                          {r.url}
                        </a>
                      ) : (
                        <span className="text-slate-400">—</span>
                      )}
                    </td>
                  </tr>
                ))}
              </tbody>
            </table>
          </div>

          <form onSubmit={addRow} className="mt-6 grid md:grid-cols-3 gap-3">
            <input
              value={form.title}
              onChange={(e) => setForm({ ...form, title: e.target.value })}
              placeholder={t.reports.tableHead[0]}
              className="p-3 rounded-2xl border bg-white"
            />
            <input
              value={form.summary}
              onChange={(e) => setForm({ ...form, summary: e.target.value })}
              placeholder={t.reports.tableHead[1]}
              className="p-3 rounded-2xl border bg-white"
            />
            <input
              value={form.url}
              onChange={(e) => setForm({ ...form, url: e.target.value })}
              placeholder={t.reports.tableHead[2]}
              className="p-3 rounded-2xl border bg-white"
            />
            <div className="md:col-span-3">
              <button type="submit" className="px-4 py-2 rounded-2xl bg-emerald-600 text-white hover:bg-emerald-700 shadow">
                + Add Row
              </button>
            </div>
          </form>
        </motion.div>
      </div>
    </section>
  );
};

const Affected = ({ t }) => {
  const [cases, setCases] = useState([]);
  const [form, setForm] = useState({
    name: "",
    location: "",
    date: "",
    category: "",
    description: "",
    source: "",
    consent: false,
  });

  const addCase = (e) => {
    e.preventDefault();
    if (!form.consent || !form.location || !form.date || !form.description) return;
    setCases((prev) => [...prev, form]);
    setForm({ name: "", location: "", date: "", category: "", description: "", source: "", consent: false });
  };

  return (
    <section id="affected" className="max-w-6xl mx-auto px-4 py-14">
      <motion.div initial={{ opacity: 0, y: 16 }} whileInView={{ opacity: 1, y: 0 }} viewport={{ once: true }} transition={{ duration: 0.6 }}>
        <h2 className="text-2xl md:text-3xl font-bold">{t.affected.heading}</h2>
        <p className="mt-2 text-sm text-slate-600">{t.affected.disclaimer}</p>

        <div className="mt-6 grid md:grid-cols-2 gap-4">
          {t.affected.categories.map((cat, idx) => (
            <details key={idx} className="group rounded-3xl border bg-white shadow-sm">
              <summary className="cursor-pointer list-none p-5 flex items-center justify-between">
                <span className="font-semibold">{cat.area}</span>
                <span className="text-slate-400 group-open:rotate-180 transition">▼</span>
              </summary>
              <div className="px-5 pb-5">
                <ul className="list-disc pl-6 text-slate-700 space-y-2">
                  {cat.impacts.map((im, i) => (
                    <li key={i}>{im}</li>
                  ))}
                </ul>
              </div>
            </details>
          ))}
        </div>

        <div className="mt-10 p-5 rounded-3xl border bg-emerald-50/50">
          <h3 className="font-semibold">{t.affected.form.title}</h3>
          <form onSubmit={addCase} className="mt-4 grid md:grid-cols-2 gap-3">
            <input
              className="p-3 rounded-2xl border bg-white"
              value={form.name}
              onChange={(e) => setForm({ ...form, name: e.target.value })}
              placeholder={t.affected.form.labels.name}
            />
            <input
              className="p-3 rounded-2xl border bg-white"
              value={form.location}
              onChange={(e) => setForm({ ...form, location: e.target.value })}
              placeholder={t.affected.form.labels.location}
              required
            />
            <input
              type="date"
              className="p-3 rounded-2xl border bg-white"
              value={form.date}
              onChange={(e) => setForm({ ...form, date: e.target.value })}
              placeholder={t.affected.form.labels.date}
              required
            />
            <select
              className="p-3 rounded-2xl border bg-white"
              value={form.category}
              onChange={(e) => setForm({ ...form, category: e.target.value })}
            >
              <option value="">{t.affected.form.labels.category}</option>
              {t.affected.categories.map((c, i) => (
                <option key={i} value={c.area}>{c.area}</option>
              ))}
            </select>
            <textarea
              className="md:col-span-2 p-3 rounded-2xl border bg-white min-h-[120px]"
              value={form.description}
              onChange={(e) => setForm({ ...form, description: e.target.value })}
              placeholder={t.affected.form.labels.description}
              required
            />
            <input
              className="md:col-span-2 p-3 rounded-2xl border bg-white"
              value={form.source}
              onChange={(e) => setForm({ ...form, source: e.target.value })}
              placeholder={t.affected.form.labels.source}
            />
            <label className="md:col-span-2 flex items-center gap-2 text-sm text-slate-600">
              <input
                type="checkbox"
                checked={form.consent}
                onChange={(e) => setForm({ ...form, consent: e.target.checked })}
              />
              {t.affected.form.labels.consent}
            </label>
            <div className="md:col-span-2">
              <button className="px-4 py-2 rounded-2xl bg-emerald-600 text-white hover:bg-emerald-700 shadow">
                {t.affected.form.labels.submit}
              </button>
            </div>
          </form>

          {cases.length > 0 && (
            <div className="mt-6 overflow-x-auto">
              <table className="w-full text-left text-sm border-separate [border-spacing:0] rounded-2xl overflow-hidden">
                <thead>
                  <tr className="bg-white">
                    <th className="p-3 border-b font-semibold">Name</th>
                    <th className="p-3 border-b font-semibold">Location</th>
                    <th className="p-3 border-b font-semibold">Date</th>
                    <th className="p-3 border-b font-semibold">Category</th>
                    <th className="p-3 border-b font-semibold">Description</th>
                    <th className="p-3 border-b font-semibold">Source</th>
                  </tr>
                </thead>
                <tbody>
                  {cases.map((c, i) => (
                    <tr key={i} className="odd:bg-white even:bg-emerald-50/40">
                      <td className="p-3 border-b align-top">{c.name || "—"}</td>
                      <td className="p-3 border-b align-top">{c.location}</td>
                      <td className="p-3 border-b align-top">{c.date}</td>
                      <td className="p-3 border-b align-top">{c.category || "—"}</td>
                      <td className="p-3 border-b align-top whitespace-pre-wrap">{c.description}</td>
                      <td className="p-3 border-b align-top">
                        {c.source ? (
                          <a className="text-emerald-700 underline break-all" href={c.source} target="_blank" rel="noreferrer">{c.source}</a>
                        ) : (
                          <span className="text-slate-400">—</span>
                        )}
                      </td>
                    </tr>
                  ))}
                </tbody>
              </table>
            </div>
          )}
        </div>
      </motion.div>
    </section>
  );
};

const Contact = ({ t }) => (
  <section id="contact" className="max-w-6xl mx-auto px-4 py-14">
    <motion.div initial={{ opacity: 0, y: 16 }} whileInView={{ opacity: 1, y: 0 }} viewport={{ once: true }} transition={{ duration: 0.6 }}>
      <h2 className="text-2xl md:text-3xl font-bold">{t.contact.heading}</h2>
      <div className="grid md:grid-cols-3 gap-6 mt-6">
        <div className="md:col-span-2 p-5 rounded-3xl border bg-white shadow-sm">
          <h3 className="font-semibold">{t.contact.addressTitle}</h3>
          <p className="mt-2 text-slate-700">{t.contact.address}</p>
          <div className="mt-4 grid sm:grid-cols-2 gap-3">
            <div className="p-4 rounded-2xl border bg-emerald-50">
              <div className="text-xs text-slate-500">{t.contact.phone}</div>
              <div className="font-medium">{t.contact.placeholders.phone}</div>
            </div>
            <div className="p-4 rounded-2xl border bg-emerald-50">
              <div className="text-xs text-slate-500">{t.contact.email}</div>
              <div className="font-medium">{t.contact.placeholders.email}</div>
            </div>
          </div>
        </div>
        <div className="p-5 rounded-3xl border bg-white shadow-sm">
          <h3 className="font-semibold">Map</h3>
          <p className="mt-2 text-slate-700 text-sm">{t.contact.mapNote}</p>
          <div className="mt-3 aspect-video rounded-2xl bg-slate-100 flex items-center justify-center text-slate-400">
            <span>Map placeholder</span>
          </div>
        </div>
      </div>
    </motion.div>
  </section>
);

const Footer = ({ t }) => (
  <footer className="border-t bg-white">
    <div className="max-w-6xl mx-auto px-4 py-6 text-sm text-slate-600 flex flex-col md:flex-row items-start md:items-center justify-between gap-3">
      <div>{t.footer.note}</div>
      <div className="flex items-center gap-2 text-xs">
        <span>© {new Date().getFullYear()} Lucky Murugan</span>
        <span>•</span>
        <a className="underline" href="#home">Back to top</a>
      </div>
    </div>
  </footer>
);

export default function LuckyMuruganSite() {
  const [lang, setLang] = useState("en");
  const t = useMemo(() => content[lang], [lang]);

  useEffect(() => {
    const prefersTA = typeof navigator !== 'undefined' &&
      (navigator.language?.toLowerCase().startsWith('ta') ||
       navigator.languages?.some(l => l.toLowerCase().startsWith('ta')));
    if (prefersTA) setLang('ta');
  }, []);

  return (
    <main className="font-sans text-slate-800">
      <Nav t={t} onSwitch={() => setLang(lang === 'en' ? 'ta' : 'en')} />
      <Hero t={t} />
      <About t={t} />
      <Leader t={t} />
      <Legacy t={t} />
      <Reports t={t} lang={lang} />
      <Affected t={t} />
      <Contact t={t} />
      <Footer t={t} />
    </main>
  );
}
